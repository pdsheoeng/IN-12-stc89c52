#include "reg52.h"
sbit I2C_SCL=P3^7;//?????,??????/??,????SDA????
sbit I2C_SDA=P3^6;//??????2????
 
/**
  * @brief  I2C??
  * @param  ?
  * @retval ?
  */
void I2C_Start(void)
{
	I2C_SDA=1;//SDA???1????0,??????SCL??????????(SCL????????0),????SDA?1
	I2C_SCL=1;
	I2C_SDA=0;//???????SDA??0?SDL?0
	I2C_SCL=0;
}
 
/**
  * @brief  I2C??
  * @param  ?
  * @retval ?
  */
void I2C_Stop(void)
{
	I2C_SDA=0;//???????RA:0(??????)????SA:1(???????),???SDA?1
	I2C_SCL=1;
	I2C_SDA=1;//???????SCL??1?SDA?1
}
 
/**
  * @brief  I2C??????
  * @param  Byte ??????
  * @retval ?
  */
void I2C_SendByte(unsigned char Byte)
{
	unsigned char i;
	for(i=0;i<8;i++)
	{
		I2C_SDA=Byte&(0x80>>i);//?SCL?0???????
		I2C_SCL=1;//???????,??????????????????,?????????
		I2C_SCL=0;
	}
}
 
/**
  * @brief  I2C??????
  * @param  ?
  * @retval ??????????
  */
unsigned char I2C_ReadByte(void)
{
	unsigned char i,Byte=0x00;//????,????
	I2C_SDA=1;//???SDA?????,??1
	for(i=0;i<8;i++)
	{
		I2C_SCL=1;
		if(I2C_SDA){Byte|=(0x80>>i);}
		I2C_SCL=0;
	}
	return Byte;
}
 
/**
  * @brief  I2C????
  * @param  AckBit ???,0???,1????
  * @retval ?
  */
void I2C_SendNAK(unsigned char AckBit)
{
	I2C_SDA=AckBit;
	I2C_SCL=1;
	I2C_SCL=0;
}
 
/**
  * @brief  I2C?????
  * @param  ?
  * @retval ???????,0???,1????
  */
unsigned char I2C_ReadACK(void)
{
	unsigned char AckBit;
	I2C_SDA=1;//???SDA?????,??1
	I2C_SCL=1;
	AckBit=I2C_SDA;
	I2C_SCL=0;
	return AckBit;
}